import{r as c,o as R,g as n,j as i,k as t,D as h,E as K,G as T,m as S,t as u,F as g,v,B as x,A as o,J as Y,f as q,P as J}from"./index-48699524.js";import{p as Q,s as P,q as tt}from"./API-2a418714.js";import{i as M,g as et}from"./axios-instance-98f3073b.js";import{h as st,F as f}from"./formatCurrency-e4c04274.js";import{u as at}from"./tokenStore-a3ec96d9.js";import{r as ot}from"./MagnifyingGlassIcon-c0dc9279.js";import{r as lt}from"./AdjustmentsVerticalIcon-18b64a28.js";const nt={key:0},it={class:"-mt-2 bg-white border-b border-gray-200",style:{position:"fixed",top:"70px",right:"0px",left:"0px"}},dt={class:"lg:ml-72 px-4"},ct={class:"flex justify-around items-center border-gray-300 py-4"},rt={class:"flex items-center justify-between border border-gray-400 border-r-0 rounded-md shadow-sm md:w-8/12 sm:w-6/12"},mt=t("option",{value:"id"},"ID",-1),ut=[mt],pt={class:"mt-8 flow-root"},ht={class:"-mx-4 -my-2 overflow-x-auto sm:-mx-7 lg:-mx-4"},gt={class:"inline-block min-w-full py-2 align-middle"},xt={class:"min-w-full divide-y divide-gray-300"},yt=t("thead",null,[t("tr",null,[t("th",{scope:"col",class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-0"}," Mã đơn "),t("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 sm:pl-0"}," Tên Khách hàng "),t("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 sm:pl-0"}," Ngày đặt "),t("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 sm:pl-0"}," Số điện thoại "),t("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 sm:pl-0"}," Tổng tiền "),t("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 sm:pl-0"}," Phương thức thanh toán "),t("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 sm:pl-0"}," Trạng thái thanh toán "),t("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 sm:pl-0"}," Trạng thái đơn hàng "),t("th",{scope:"col",class:"py-3 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-0"}," Hoạt động ")])],-1),vt={class:"divide-y divide-gray-200 bg-white"},ft={class:"whitespace-nowrap px-3 py-5 text-sm text-gray-900 sm:pl-2"},_t={class:"text-gray-900"},bt={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm text-gray-900 sm:pl-0"},wt={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-900 sm:pl-0"},Dt={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-900 sm:pl-0"},Ct={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-900 sm:pl-0"},kt={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-900 sm:pl-0"},Tt={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-900 sm:pl-0"},St={key:0},Pt=["onUpdate:modelValue","onChange"],At=["value","disabled"],zt={key:1,class:"whitespace-nowrap px-3 py-4 text-sm text-gray-900 sm:pl-0"},Nt={class:"py-4"},Ht=["onClick"],Vt={class:"sr-only"},jt={key:1,class:"overflow-y-auto"},It={class:"order-detail-page"},Mt=t("div",{class:"px-4 py-3"},[t("h1",{class:"text-xl font-semibold leading-7 text-gray-900"}," Chi tiết đơn hàng ")],-1),$t={class:"my-6 border-t border-gray-100"},Lt={class:"divide-y divide-gray-100"},Ut={class:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-4"},Zt=t("dt",{class:"text-sm font-medium leading-6 text-gray-900"}," Tên khách hàng ",-1),Ot={class:"mt-1 text-sm leading-6 text-gray-700 sm:col-span-2 sm:mt-0"},Ft={class:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-4"},Bt=t("dt",{class:"text-sm font-medium leading-6 text-gray-900"}," Ngày đặt ",-1),Gt={class:"mt-1 text-sm leading-6 text-gray-700 sm:col-span-2 sm:mt-0"},Et={class:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-4"},Wt=t("dt",{class:"text-sm font-medium leading-6 text-gray-900"}," Số điện thoại ",-1),Xt={class:"mt-1 text-sm leading-6 text-gray-700 sm:col-span-2 sm:mt-0"},Rt={class:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-4"},Kt=t("dt",{class:"text-sm font-medium leading-6 text-gray-900"},"Địa chỉ",-1),Yt={class:"mt-1 text-sm leading-6 text-gray-700 sm:col-span-2 sm:mt-0"},qt={class:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-4"},Jt=t("dt",{class:"text-sm font-medium leading-6 text-gray-900"}," Tổng tiền ",-1),Qt={class:"mt-1 text-sm leading-6 text-gray-700 sm:col-span-2 sm:mt-0"},te={class:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-4"},ee=t("dt",{class:"text-sm font-medium leading-6 text-gray-900"}," Loại thanh toán ",-1),se={class:"mt-1 text-sm leading-6 text-gray-700 sm:col-span-2 sm:mt-0"},ae={class:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-4"},oe=t("dt",{class:"text-sm font-medium leading-6 text-gray-900"}," Trạng thái thanh toán ",-1),le={class:"mt-1 text-sm leading-6 text-gray-700 sm:col-span-2 sm:mt-0"},ne={class:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-4"},ie=t("dt",{class:"text-sm font-medium leading-6 text-gray-900"}," Trạng thái đơn hàng ",-1),de={key:0},ce=["value","disabled"],re={key:0,type:"button",class:"rounded-md ml-3 bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"},me={key:1,class:"mt-1 text-sm leading-6 text-gray-700 sm:col-span-2 sm:mt-0"},ue={class:"mt-6 overflow-x-auto"},pe=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"}," Chi tiết sản phẩm ",-1),he={class:"min-w-full divide-y divide-gray-200"},ge=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Hình ảnh "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tên sản phẩm "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Loại "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Giá "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Màu "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Size "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Số lượng "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tổng tiền ")])],-1),xe={class:"bg-white divide-y divide-gray-200"},ye={class:"px-6 py-4 whitespace-nowrap"},ve=["src"],fe={class:"px-6 py-4 whitespace-nowrap"},_e={class:"px-6 py-4 whitespace-nowrap"},be={class:"px-6 py-4 whitespace-nowrap"},we={class:"px-6 py-4 whitespace-nowrap"},De={class:"px-6 py-4 whitespace-nowrap"},Ce={class:"px-6 py-4 whitespace-nowrap"},ke={class:"px-6 py-4 whitespace-nowrap"},Te=t("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1),Se=J('<div class="bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4"><div class="sm:flex sm:items-start"><div class="mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left"><h3 class="text-base font-semibold leading-6 text-gray-900" id="modal-title"> Xác nhận thay đổi trạng thái </h3><div class="mt-2"><p class="text-sm text-gray-500"> Bạn có chắc chắn muốn muốn thay đổi trạng thái đơn hàng </p></div></div></div></div>',1),Pe={key:2,class:"w-full h-full flex justify-center items-center",style:{position:"fixed",top:"0",left:"0","z-index":"100"}},Ae={class:"flex justify-center items-center"},ze=t("div",{class:"bg-gray-500",style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",opacity:"0.3"}},null,-1),Ne={class:"spinner-border text-white",role:"status"},Ze={__name:"TransactionList",setup(He){const p=c(!1),_=at(),r=c([{id:19,customerId:3,status:1,status1:1,addressId:1,createdAt:"2023-12-04T13:33:59.000Z",updatedAt:"2023-12-04T13:33:59.000Z",deletedAt:null,paymentData:{id:15,paymentType:2,status:1,total:3e5,transaction:null,discountCode:"NGUYENHAU2",createdAt:"2023-12-04T13:33:59.000Z"},addressData:{id:1,name:"Nguyen Cong Hau",phone:"0123456789",customerId:2,city:"Ha Noi",district:"Ba Vi",commune:"Phong Van",street:"xom Giau",createdAt:"2023-11-29T09:52:39.000Z",updatedAt:"2023-11-29T09:59:19.000Z",deletedAt:null}}]),b=c(!1),w=c(!1),m=c(null),l=c({id:1,customerId:1,status:3,status1:3,createdAt:"2023-12-07T16:34:47.000Z",updatedAt:"2023-12-07T16:34:47.000Z",deletedAt:null,orderItemData:[{id:1,amount:4,price:1e5,orderProductSizeColorData:{id:3,price:1e5,productData:{id:1,name:"Product 1",mainImage:"https://via.placeholder.com/500",categoryData:{id:1,name:"Category 1"}},colorData:{id:1,name:"Red"},sizeData:{id:3,name:"M"}}},{id:2,amount:1,price:1e5,orderProductSizeColorData:{id:1,price:1e5,productData:{id:1,name:"Product 1",mainImage:"https://via.placeholder.com/500",categoryData:{id:1,name:"Category 1"}},colorData:{id:1,name:"Red"},sizeData:{id:1,name:"XS"}}},{id:3,amount:1,price:1e5,orderProductSizeColorData:{id:2,price:1e5,productData:{id:1,name:"Product 1",mainImage:"https://via.placeholder.com/500",categoryData:{id:1,name:"Category 1"}},colorData:{id:1,name:"Red"},sizeData:{id:2,name:"S"}}}],paymentData:{id:1,paymentType:2,status:1,total:3e5,transaction:null,discountCode:"NGUYENHAU2",createdAt:"2023-12-07T16:34:47.000Z"},addressData:{id:1,name:"Nguyen Cong Hau",phone:"0123456789",customerId:2,city:"Ha Noi",district:"Ba Vi",commune:"Phong Van",street:"xom Giau",createdAt:"2023-11-29T09:52:39.000Z",updatedAt:"2023-11-29T09:59:19.000Z",deletedAt:null}}),y=c(!1),D=c("id"),C=c(""),A=[{value:1,label:"Chờ xác nhận"},{value:2,label:"Đã Xác nhận"},{value:3,label:"Đang giao"},{value:4,label:"Đã giao"},{value:0,label:"Hủy"}],$=[{value:1,label:"Khi nhận hàng"},{value:2,label:"VNPay"}],L=[{value:1,label:"Chưa thanh toán"},{value:2,label:"Đã thanh toán"},{value:0,label:"Đã huỷ"},{value:-1,label:"Hoàn tiền"}],k=c([]),z=a=>st(a).format("HH:mm - DD/MM/yyyy"),U=a=>a?`${a.street}, ${a.commune}, ${a.district}, ${a.city}`:"",Z=a=>{const s=$.find(e=>e.value==a);return s?s.label:""},O=a=>{const s=L.find(e=>e.value==a);return s?s.label:""};R(async()=>{p.value=!0,_.role==1?_.onSetCurrentPage({index:3,child:0}):_.onSetCurrentPage({index:1,child:0}),await F(),N(),p.value=!1});const F=async()=>{await M.get(Q).then(a=>{r.value=a.data.data,r.value.forEach(s=>{s.status1=s.status})}).catch(a=>{const s=a.response.data.message?a.response.data.message:"Lỗi";P(s,!0),console.error(s,a)})},N=()=>{const a=C.value.toString().toLowerCase().trim();switch(D.value){case"id":k.value=r.value.filter(s=>s.id.toString().toLowerCase().includes(a));break;case"name":k.value=r.value.filter(s=>s.name.toString().toLowerCase().includes(a));break}},B=async a=>{y.value=!0},G=()=>{y.value=!1},H=(a,s)=>{s||(m.value=a,E())},V=a=>new Promise(s=>setTimeout(s,a)),E=async()=>{b.value=!0,await V(100),w.value=!0},W=async()=>{p.value=!0;try{const a=r.value[m.value],s=new FormData;s.append("status",a.status1),await M.put(`${tt}/${a.id}`,s).then(e=>{r.value[m.value].status=r.value[m.value].status1,P("Cập nhật thành công")}).catch(e=>{P("Lỗi",!0),console.log(e)})}catch{}p.value=!1,j()},X=()=>{try{r.value[m.value].status1=r.value[m.value].status,j()}catch{}},j=async()=>{m.value=null,w.value=!1,await V(500),b.value=!1};return(a,s)=>(n(),i(g,null,[y.value?x("",!0):(n(),i("div",nt,[t("div",it,[t("div",dt,[t("div",ct,[t("div",rt,[h(t("input",{type:"text",placeholder:"Tìm kiếm ...","onUpdate:modelValue":s[0]||(s[0]=e=>C.value=e),class:"rounded-md w-full rounded-r-none border-0 px-3 py-2 text-sm focus:border-gray-50 focus:border-0"},null,512),[[K,C.value]]),h(t("select",{"onUpdate:modelValue":s[1]||(s[1]=e=>D.value=e),class:"border-0 px-3 py-2 text-sm focus:outline-0"},ut,512),[[T,D.value]]),t("button",{type:"button",onClick:s[2]||(s[2]=e=>N()),class:"inline-flex items-center rounded-md rounded-l-none bg-indigo-600 px-1 py-1 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"},[S(u(ot),{class:"h-7 w-7","aria-hidden":"true"})])])])])]),t("div",pt,[t("div",ht,[t("div",gt,[t("table",xt,[yt,t("tbody",vt,[(n(!0),i(g,null,v(k.value,(e,I)=>(n(),i("tr",{key:I},[t("td",ft,[t("div",_t,o(e.id),1)]),t("td",bt,o(e.addressData.name),1),t("td",wt,o(z(e.createdAt)),1),t("td",Dt,o(e.addressData.phone),1),t("td",Ct,o(u(f)(e.paymentData.total)),1),t("td",kt,o(Z(e.paymentData.paymentType)),1),t("td",Tt,o(O(e.paymentData.status)),1),e.status!=0?(n(),i("td",St,[h(t("select",{"onUpdate:modelValue":d=>e.status1=d,onChange:d=>H(I,!1),class:"rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring focus:border-indigo-500"},[(n(),i(g,null,v(A,d=>t("option",{key:d.value,value:d.value,disabled:d.value!=0&&(d.value<=e.status||d.value>e.status+1)},o(d.label),9,At)),64))],40,Pt),[[T,e.status1]])])):(n(),i("td",zt," Huỷ ")),t("td",Nt,[t("button",{class:"hover:text-indigo-900 ml-10",onClick:d=>B(e.id)},[S(u(lt),{class:"h-5 w-5","aria-hidden":"true"}),t("span",Vt,", "+o(e.id),1)],8,Ht)])]))),128))])])])])])])),y.value?(n(),i("div",jt,[t("div",It,[Mt,t("div",$t,[t("dl",Lt,[t("div",Ut,[Zt,t("dd",Ot,o(l.value.addressData.name),1)]),t("div",Ft,[Bt,t("dd",Gt,o(z(l.value.createdAt)),1)]),t("div",Et,[Wt,t("dd",Xt,o(l.value.addressData.phone),1)]),t("div",Rt,[Kt,t("dd",Yt,o(U(l.value.addressData)),1)]),t("div",qt,[Jt,t("dd",Qt,o(u(f)(l.value.paymentData.total)),1)]),t("div",te,[ee,t("dd",se,o(l.value.paymentData.paymentType),1)]),t("div",ae,[oe,t("dd",le,o(l.value.paymentData.status),1)]),t("div",ne,[ie,l.value.status!=0?(n(),i("dd",de,[h(t("select",{"onUpdate:modelValue":s[3]||(s[3]=e=>l.value.status1=e),onChange:s[4]||(s[4]=e=>H(!1,!0)),class:"rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring focus:border-indigo-500"},[(n(),i(g,null,v(A,e=>t("option",{key:e.value,value:e.value,disabled:e.value!=0&&(e.value<l.value.status||e.value>l.value.status+2)},o(e.label),9,ce)),64))],544),[[T,l.value.status1]]),l.value.status1!=l.value.status?(n(),i("button",re," Xác nhận ")):x("",!0)])):l.value.status==0?(n(),i("dd",me," Hủy ")):x("",!0)]),t("div",ue,[pe,t("table",he,[ge,t("tbody",xe,[(n(!0),i(g,null,v(l.value.orderItemData,e=>(n(),i("tr",{key:e.id},[t("td",ye,[t("img",{src:e.orderProductSizeColorData.productData.mainImage,alt:"Product Image",class:"h-12 w-12 sm:h-8 sm:w-8 md:h-12 md:w-12 lg:h-16 lg:w-16 object-cover"},null,8,ve)]),t("td",fe,o(e.orderProductSizeColorData.productData.name),1),t("td",_e,o(e.orderProductSizeColorData.productData.categoryData.name),1),t("td",be,o(u(f)(e.orderProductSizeColorData.price)),1),t("td",we,o(e.orderProductSizeColorData.colorData.name),1),t("td",De,o(e.orderProductSizeColorData.sizeData.name),1),t("td",Ce,o(e.amount),1),t("td",ke,o(u(f)(e.price)),1)]))),128))])])])])]),t("div",{style:{position:"fixed",bottom:"0px",right:"0px",left:"0px"},class:"lg:ml-72"},[t("div",{class:"bg-gray-50 px-4 py-3 flex justify-end"},[t("button",{onClick:G,type:"button",class:"inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring focus:border-indigo-500 sm:w-auto sm:text-sm"}," Quay lại ")])])])])):x("",!0),h(t("div",null,[t("div",{class:q([{"opacity-100":w.value},"transition-opacity ease-in-out duration-500 opacity-0 relative z-10"]),"aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},[Te,t("div",{class:"fixed inset-0 z-10 w-screen"},[t("div",{class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},[t("div",{class:"relative transform rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg lg:ml-64 mt-10"},[Se,t("div",{class:"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6"},[t("button",{type:"button",onClick:W,class:"inline-flex w-full justify-center rounded-md bg-green-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-500 sm:ml-3 sm:w-auto"}," Đồng ý "),t("button",{type:"button",onClick:X,class:"inline-flex w-full justify-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-500 sm:ml-3 sm:w-auto"}," Huỷ ")])])])])],2)],512),[[Y,b.value]]),p.value?(n(),i("div",Pe,[t("div",Ae,[ze,t("div",Ne,[S(u(et),{color:"blue",size:"12",class:"lg:ml-64 mt-10"})])])])):x("",!0)],64))}};export{Ze as default};
